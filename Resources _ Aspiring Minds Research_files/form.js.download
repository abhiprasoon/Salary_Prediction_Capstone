jQuery(document).ready(function() {
    jQuery("a").click(function(event) {
		var currentID = event.target.id;
		
		if(currentID =='close-ner'){
			jQuery('#showForm').hide();
		}
		});
		
		
     
    jQuery("img").click(function(event) {
		var currentID = event.target.id;
		//alert(currentID);
		//jQuery('input').remove('#events');
		//jQuery('input').remove('#saveFor');
		jQuery('input').remove('#report_path');
		//jQuery('input').remove('#report_name');
		//jQuery('input').remove('#mailSubject');
		
		if(currentID =='close-ner'){
			jQuery('#showForm').hide();
		}else{
		
		    
			//var title = jQuery('#'+currentID+'_heading').text();
			//var eventName = jQuery('#'+currentID+'_eventName').text();
			//var report_path = jQuery('#'+currentID+'_path').text();
			//var report_name = jQuery('#'+currentID+'_name').text();
			var report_path = currentID;
			jQuery("#form").show();
			jQuery("#Submit").show();
			jQuery("#showThank").hide();
			jQuery("#showError").hide();
			//jQuery('#title').text(title);
			jQuery('#close-ner').show();
			jQuery('#showForm').show();
			jQuery("#name").val("");
			jQuery("#mobile").val("");
			jQuery("#email").val("");	
			jQuery("#organisation").val("");
			jQuery("#hearAbtUs").val("");
			//jQuery("#loader").hide();
			
			
			jQuery('<input>').attr({
				type: 'hidden',	id: 'report_path', name: 'report_path',	value: report_path,
			}).appendTo('form');
			
			//jQuery(window).scrollTop(jQuery('.moreContainerNoHero').offset().top);
			
			//alert(currentID);
			//alert(title);
		}
    });
	
	jQuery('#Submit').click(function() {
		
		var errMsg 			= "";
		var name 			= jQuery("#name").val();
		var mobile 			= jQuery("#mobile").val();
		var email 			= jQuery("#email").val();	
		var organisation 	= jQuery("#organisation").val();
		var hearAbtUs 		= jQuery("#hearAbtUs").val();
		var saveFor 		= "";
		var events 			= "";
		var report_path		= jQuery("#report_path").val();
		var mailSubject		= "";
		if ( name == "")
			errMsg += "Please enter your Name.\n";
		else if (!name.match(/^[\sa-zA-Z.]+$/))
			errMsg += "Name can have alphabets only.\n";
		if (email == "")
			errMsg += "Please enter your Email ID.\n";
		else if (echeck(email) == false)		
			errMsg += "Please enter a valid Email ID.\n";
		if (organisation == "")
			errMsg += "Please enter your Organisation.\n";
		if (mobile != "")
		{
			if (!mobile.match(/^[0-9]{10}$/))
			errMsg += "Please enter a valid Mobile number.\n";
		}
		
		
		if (errMsg != "") {
			alert(errMsg);
			
		} else {
			
			//jQuery("#loader").show();
			jQuery.ajax ({
					type: "GET",
					url: "../insertdb.php",
					data: "name="+name+"&mobile="+mobile+"&email="+email+"&hearAbtUs="+hearAbtUs+"&organisation="+organisation+"&report_path="+report_path,
					success: function(msg) {
						if(msg == "success"){
							//jQuery("#loader").hide();
							jQuery("#showThank").show();
							jQuery("#form").hide();
							jQuery("#Submit").hide();
							//window.location.href=msg;
							//jQuery('#fileName').val(msg);
							jQuery('#form').attr('action','../download_report.php');
							jQuery('#form').submit();			
						}else{
							//jQuery("#loader").hide();
							jQuery("#form").hide();
							jQuery("#Submit").hide();
							jQuery("#showError").show();
						}
					}
			});	
		}
	});
	
});
function echeck(str)
	{	
		var at="@"
		var dot="."
		var lat=str.indexOf(at)
		var lstr=str.length
		var ldot=str.indexOf(dot)
		if (str.indexOf(at)==-1)
		return false;
		if (str.indexOf(at)==-1 || str.indexOf(at)==0 || str.indexOf(at)==lstr)
			return false;
		if (str.indexOf(dot)==-1 || str.indexOf(dot)==0 || str.indexOf(dot)==lstr)
			return false;
		if (str.indexOf(at,(lat+1))!=-1)
			return false;
		if (str.substring(lat-1,lat)==dot || str.substring(lat+1,lat+2)==dot)
			return false;
		if (str.indexOf(dot,(lat+2))==-1)
			return false;
		if (str.indexOf(" ")!=-1)
			return false;
		return true;

	}